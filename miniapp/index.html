<!-- miniapp/index.html -->

<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Mini App</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Segoe UI', sans-serif; min-height:100vh; background: linear-gradient(135deg,#0f2027,#203a43,#2c5364); display:flex; flex-direction:column; align-items:center; justify-content:flex-start; color:#fff; overflow-x:hidden; }
nav { width:100%; padding:15px 30px; background: rgba(0,0,0,0.4); display:flex; justify-content:space-between; align-items:center; position:fixed; top:0; left:0; box-shadow:0 4px 15px rgba(0,0,0,0.5); z-index:1000; backdrop-filter:blur(5px); }
nav h1 { font-size:26px; }
nav .menu a { color:#fff; text-decoration:none; margin-left:25px; font-size:16px; transition:0.3s; }
nav .menu a:hover { color:#ff6a00; }
.container { margin-top:120px; background: rgba(0,0,0,0.35); padding:50px 60px; border-radius:25px; box-shadow:0 15px 40px rgba(0,0,0,0.6); text-align:center; width:90%; max-width:450px; transition:transform 0.3s; }
.container:hover { transform: scale(1.03); }
h2 { font-size:30px; margin-bottom:25px; text-shadow:2px 2px 8px #000; }
input { padding:15px 20px; font-size:16px; border-radius:15px; border:none; margin-bottom:25px; width:100%; outline:none; transition:0.3s; }
input:focus { box-shadow:0 0 15px #ff6a00; transform: scale(1.02); }
button { background: linear-gradient(45deg,#ff6a00,#ff8c42); border:none; border-radius:15px; padding:15px 35px; font-size:16px; color:#fff; cursor:pointer; transition:0.3s; box-shadow:0 8px 15px rgba(0,0,0,0.5); }
button:hover { transform: translateY(-3px) scale(1.05); background: linear-gradient(45deg,#ff8c42,#ff6a00); }
#message { margin:15px auto 0 auto; padding:12px 25px; display:flex; justify-content:center; align-items:center; font-size:20px; font-weight:bold; display:none; border-radius:8px; text-align:center; }
#message.success { background-color:#4caf50; }
#message.error { background-color:#ff3b3b; }
footer { margin-top:auto; padding:20px; text-align:center; font-size:14px; color:rgba(255,255,255,0.7); width:100%; }

/* ðŸ“± Telefon uchun responsiv */
@media (max-width: 600px) {
  nav h1 { font-size:20px; }
  nav .menu a { font-size:14px; margin-left:15px; }
  .container { margin-top:100px; padding:30px 25px; border-radius:18px; width:95%; }
  h2 { font-size:22px; margin-bottom:20px; }
  input { padding:12px 15px; font-size:14px; }
  button { padding:12px 25px; font-size:14px; }
  #message { font-size:16px; padding:10px 15px; }
}
</style>
</head>
<body>

<nav>
  <h1>Konkursâš¡</h1>
  <div class="menu">
    <a href="index2.html">Dasturchi</a>
    <a href="#">Admin</a>
  </div>
</nav>

<div class="container">
  <h2>ID raqamingizni yozing</h2>
  <input type="text" id="user_id" placeholder="ID raqamingiz">
  <br>
  <button id="submitBtn">Yuborish</button>
  <div id="message"></div>
</div>

<footer>&copy; 2025 Djurakulov. Dasturchi </footer>

<script>
const input = document.getElementById("user_id");
const button = document.getElementById("submitBtn");
const msgBox = document.getElementById("message");

button.addEventListener("click", async () => {
    const id = input.value.trim();
    
    // ID validatsiyasi: raqam, 5+ belgi, 139 yoki 140 bilan boshlanishi
    if (!/^\d{5,}$/.test(id) || !(id.startsWith("139") || id.startsWith("140"))) {
        msgBox.textContent = "Notoâ€˜gâ€˜ri ID 139 yoki 140 ";
        msgBox.className = "error";
        msgBox.style.display = "flex";
        setTimeout(() => msgBox.style.display="none",2000);
        return;
    }

    try {
        const formData = new FormData();
        formData.append("user_id", id);

        const res = await fetch(`/save_id`, { method:"POST", body:formData });
        const text = await res.text();

        if(res.status===200){
            msgBox.textContent="âœ” ID muvaffaqiyatli yuborildi!";
            msgBox.className="success";
            msgBox.style.display="flex";
            input.disabled=true;
            button.disabled=true;
            button.textContent="Yuborildi âœ…";
        } else {
            msgBox.textContent=text;
            msgBox.className="error";
            msgBox.style.display="flex";
        }
        setTimeout(()=>msgBox.style.display="none",3000);
    } catch(err){
        console.error("Server bilan bogâ€˜lanishda xatolik:",err);
        msgBox.textContent="Server bilan bogâ€˜lanishda xatolik!";
        msgBox.className="error";
        msgBox.style.display="flex";
        setTimeout(()=>msgBox.style.display="none",3000);
    }
});
</script>

</body>
</html>
